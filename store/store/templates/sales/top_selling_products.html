{% extends 'base.html' %}

{% load humanize %}

{% block content %}
<h1 class="text-center">Top selling Products</h1>
<div class="table-responsive">
    <table class="table table-striped table-bordered table-sm">
        <tr>
            <th>Product Name</th>
            <th>Total Quantity</th>
            <th>Unit Price</th>
            <th>Current Cost</th>
            
          
        </tr>
        {% for product in top_products %}
        <tr>
            <td>{{product.name}}</td>
            <td>{{product.total_quantity_sold}}</td>
            <td>{{product.standard_price|intcomma}}</td>
            <td>{{product.current_cost|intcomma}}</td>
            
            
        </tr>
        {% endfor %}
    </table>
</div>
    
    
<div class="container">
    <div class="row justify-content-center">
        <div class="col-lg-12">
            <div class="chart-container">
                <canvas id="chart"></canvas>
            </div>
            
        </div>
    </div>
</div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var ctx = document.getElementById('chart').getContext('2d');
            
            var data = {
                labels: [
                    {% for product in top_products %}
                        "{{ product.name }}",
                    {% endfor %}
                ],
                datasets: [
                    {
                        label: 'Quantity Sold',
                        data: [
                            {% for product in top_products %}
                                {{ product.total_quantity_sold }},
                            {% endfor %}
                        ],
                        backgroundColor: [
                        "#fd7f6f", 
                        "#7eb0d5", 
                        "#b2e061", 
                        "#bd7ebe", 
                        "#ffb55a", 
                        "#ffee65", 
                        "#beb9db", 
                        "#fdcce5",
                        "#8bd3c7"
                        ],
                    },
                    {
                        label: 'Price',
                        data: [
                            {% for product in top_products %}
                                {{ product.price }},
                            {% endfor %}
                        ],
                        backgroundColor: [
                        "#fd7f6f", 
                        "#7eb0d5", 
                        "#b2e061", 
                        "#bd7ebe", 
                        "#ffb55a", 
                        "#ffee65", 
                        "#beb9db", 
                        "#fdcce5",
                        "#8bd3c7"
                        ],
                    }
                ]
            };
    
            var options = {
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Quantity Sold',
                        }
                    }
                }
            };
    
            var chart = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: options
            });
        });
    </script>
    
    
{% endblock content %}
